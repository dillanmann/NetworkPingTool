@using NetworkPingTool.Model;

@inherits MudComponentBase

<MudTooltip Text="@toolTipText">
    <MudIcon Icon="@Icons.Material.Filled.Circle" Color="@iconColor" />
</MudTooltip>

@code {
    [Parameter]
    public PingHealthStatus HealthStatus { get; set; }

    [Parameter]
    public long MinRoundTripTime { get; set; }

    [Parameter]
    public long MaxRoundTripTime { get; set; }

    private string toolTipText = "No data";
    private Color iconColor = Color.Info;

    protected override void OnParametersSet()
    {
        iconColor = GetIconColorFromHealthStatus(HealthStatus);
        toolTipText = GetToolTipTextFromHealthStatus(HealthStatus);
    }

    private Color GetIconColorFromHealthStatus(PingHealthStatus status)
    {
        switch (status)
        {
            case PingHealthStatus.Green:
                return Color.Success;
            case PingHealthStatus.Amber:
                return Color.Warning;
            case PingHealthStatus.Red:
                return Color.Error;
            default:
                return Color.Info;
        }
    }

    private string GetToolTipTextFromHealthStatus(PingHealthStatus status)
    {
        var minMaxStatText = $"\nMax:{MaxRoundTripTime}ms\nMin:{MinRoundTripTime}ms";
        var textStatus = "";
        switch (status)
        {
            case PingHealthStatus.Green:
                textStatus = "Healthy";
                break;
            case PingHealthStatus.Amber:
                textStatus = "Unhealthy";
                break;
            case PingHealthStatus.Red:
                textStatus = "Faulted";
                break;
        }

        return $"{textStatus}{minMaxStatText}";
    }
}
